<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>IGA framework: /home/juan/xul_ga/igap/app/floorplanner/parseTree.py Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>/home/juan/xul_ga/igap/app/floorplanner/parseTree.py</h1><a href="parseTree_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespaceapp_1_1floorplanner_1_1parseTree.html">00001</a> 
<a name="l00002"></a><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html">00002</a> <span class="keyword">class </span><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html">tree_node</a>:
<a name="l00003"></a><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#f71ae34ea1b4e1615335a2b1ce94d665">00003</a>     <span class="keyword">def </span><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#f71ae34ea1b4e1615335a2b1ce94d665">__init__</a>(self,orientation,percent,childOne=None,childTwo=None):
<a name="l00004"></a><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#5e08ea4026925e4f6d96df9289fa253a">00004</a>         self.<a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#5e08ea4026925e4f6d96df9289fa253a">orientation</a> = orientation
<a name="l00005"></a><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#bad58fd2adcb7a648e1935431d2ed393">00005</a>         self.<a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#bad58fd2adcb7a648e1935431d2ed393">percent</a> = percent
<a name="l00006"></a><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#d912ea0e64f9e571db0fad3ab446277b">00006</a>         self.<a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#d912ea0e64f9e571db0fad3ab446277b">childOne</a> = childOne
<a name="l00007"></a><a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#9eeaa1cb0ce51526449066a14480e7c3">00007</a>         self.<a class="code" href="classapp_1_1floorplanner_1_1parseTree_1_1tree__node.html#9eeaa1cb0ce51526449066a14480e7c3">childTwo</a> = childTwo
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="namespaceapp_1_1floorplanner_1_1parseTree.html#a65a233e725f557bd223f2cc06aaf64b">00009</a> <span class="keyword">def </span><a class="code" href="namespaceapp_1_1floorplanner_1_1parseTree.html#a65a233e725f557bd223f2cc06aaf64b">traverse</a>(node,startx,starty,length,height):
<a name="l00010"></a>00010     results = []
<a name="l00011"></a>00011     <span class="keywordflow">if</span> <span class="keywordflow">not</span> node.childOne <span class="keywordflow">and</span> <span class="keywordflow">not</span> node.childTwo:
<a name="l00012"></a>00012         results.append( (startx,starty,startx+length,starty+height) )
<a name="l00013"></a>00013     <span class="keywordflow">else</span>:
<a name="l00014"></a>00014         <span class="keywordflow">if</span> node.orientation == 1:
<a name="l00015"></a>00015             top_startx = startx
<a name="l00016"></a>00016             top_starty = starty
<a name="l00017"></a>00017             top_length = length
<a name="l00018"></a>00018             top_height = height*node.percent
<a name="l00019"></a>00019             bottom_startx = top_startx
<a name="l00020"></a>00020             bottom_starty = top_starty + top_height
<a name="l00021"></a>00021             bottom_length = length
<a name="l00022"></a>00022             bottom_height = height - top_height
<a name="l00023"></a>00023             <span class="keywordflow">if</span> node.childOne:
<a name="l00024"></a>00024                 results.extend(traverse(node.childOne,top_startx,top_starty,top_length,top_height))
<a name="l00025"></a>00025             <span class="keywordflow">if</span> node.childTwo:
<a name="l00026"></a>00026                 results.extend(traverse(node.childTwo,bottom_startx,bottom_starty,bottom_length,bottom_height))
<a name="l00027"></a>00027         <span class="keywordflow">elif</span> node.orientation == 2:
<a name="l00028"></a>00028             left_startx = startx
<a name="l00029"></a>00029             left_starty = starty
<a name="l00030"></a>00030             left_length = length*node.percent
<a name="l00031"></a>00031             left_height = height
<a name="l00032"></a>00032             right_startx = startx + left_length
<a name="l00033"></a>00033             right_starty = starty
<a name="l00034"></a>00034             right_length = length - left_length
<a name="l00035"></a>00035             right_height = height
<a name="l00036"></a>00036             <span class="keywordflow">if</span> node.childOne:
<a name="l00037"></a>00037                 results.extend(traverse(node.childOne,left_startx,left_starty,left_length,left_height))
<a name="l00038"></a>00038             <span class="keywordflow">if</span> node.childTwo:
<a name="l00039"></a>00039                 results.extend(traverse(node.childTwo,right_startx,right_starty,right_length,right_height))
<a name="l00040"></a>00040 
<a name="l00041"></a>00041     <span class="keywordflow">return</span> results
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="namespaceapp_1_1floorplanner_1_1parseTree.html#84dac6f161ec5ff6a651af70f549d8ce">00044</a> <span class="keyword">def </span><a class="code" href="namespaceapp_1_1floorplanner_1_1parseTree.html#84dac6f161ec5ff6a651af70f549d8ce">parseTree</a>(ind, plotSizeX, plotSizeY):
<a name="l00045"></a>00045 
<a name="l00046"></a>00046     plan = []
<a name="l00047"></a>00047     tree = ind.genome
<a name="l00048"></a>00048     plan.append(tree[0])
<a name="l00049"></a>00049     tree = tree[1:]
<a name="l00050"></a>00050     
<a name="l00051"></a>00051     curpos = []
<a name="l00052"></a>00052     termconditions = []
<a name="l00053"></a>00053     <span class="keyword">global</span> termCond 
<a name="l00054"></a>00054     <span class="keyword">global</span> currInLine
<a name="l00055"></a>00055     <span class="keyword">global</span> currLine
<a name="l00056"></a>00056     <span class="keyword">global</span> currLoc
<a name="l00057"></a>00057 
<a name="l00058"></a>00058     termCond = []
<a name="l00059"></a>00059     currInLine = []
<a name="l00060"></a>00060 
<a name="l00061"></a>00061     <span class="keyword">def </span>reclosefunc():
<a name="l00062"></a>00062 
<a name="l00063"></a>00063         <span class="keyword">global</span> currInLine
<a name="l00064"></a>00064         <span class="keyword">global</span> currLine
<a name="l00065"></a>00065         <span class="keyword">global</span> currLoc
<a name="l00066"></a>00066         <span class="keyword">global</span> termCond
<a name="l00067"></a>00067 
<a name="l00068"></a>00068         currInLine[currLine][currLoc] = 2
<a name="l00069"></a>00069         <span class="keywordflow">if</span> currInLine != termCond:
<a name="l00070"></a>00070             <span class="keywordflow">if</span> currLoc % 2 != 0:
<a name="l00071"></a>00071                 currLine = currLine - 1
<a name="l00072"></a>00072                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(len(tree[currLine])):
<a name="l00073"></a>00073                     <span class="keywordflow">if</span> currInLine[currLine][i] == 1:
<a name="l00074"></a>00074                         currLoc = i
<a name="l00075"></a>00075                         reclosefunc()
<a name="l00076"></a>00076                         <span class="keywordflow">break</span>
<a name="l00077"></a>00077                         
<a name="l00078"></a>00078             <span class="keywordflow">else</span>:
<a name="l00079"></a>00079                 currLoc = currLoc + 1
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(len(tree)):
<a name="l00082"></a>00082         <span class="keywordflow">for</span> j <span class="keywordflow">in</span> xrange(len(tree[i])):
<a name="l00083"></a>00083             curpos.append(0)
<a name="l00084"></a>00084             termconditions.append(2)
<a name="l00085"></a>00085         currInLine.append(curpos)
<a name="l00086"></a>00086         termCond.append(termconditions)
<a name="l00087"></a>00087         curpos = []
<a name="l00088"></a>00088         termconditions = []
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     currLine = 0
<a name="l00091"></a>00091     currLoc = currInLine[currLine][0]
<a name="l00092"></a>00092                 
<a name="l00093"></a>00093     <span class="keywordflow">while</span> (currInLine != termCond):
<a name="l00094"></a>00094         currInLine[currLine][currLoc] = 1
<a name="l00095"></a>00095         plan.append(tree[currLine][currLoc])
<a name="l00096"></a>00096 
<a name="l00097"></a>00097         <span class="keywordflow">if</span> tree[currLine][currLoc][1] == 1.0 <span class="keywordflow">or</span> tree[currLine][currLoc][1] == 0.0:
<a name="l00098"></a>00098             reclosefunc()    
<a name="l00099"></a>00099         <span class="keywordflow">else</span>:
<a name="l00100"></a>00100             currLine = currLine + 1
<a name="l00101"></a>00101             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(len(tree[currLine])):
<a name="l00102"></a>00102                 <span class="keywordflow">if</span> currInLine[currLine][i] == 0:
<a name="l00103"></a>00103                     currLoc = i
<a name="l00104"></a>00104                     <span class="keywordflow">break</span>
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     plotRooms = []
<a name="l00107"></a>00107     plotElements = [(0,0,plotSizeX,plotSizeY)]
<a name="l00108"></a>00108     roomDesc = []
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(0,len(plan)):
<a name="l00111"></a>00111         <span class="keywordflow">if</span> plan[i][1] != 1.0 <span class="keywordflow">and</span> plan[i][1] != 0.0:
<a name="l00112"></a>00112             tree = tree_node(plan[i][0],plan[i][1],tree_node(1,1,<span class="keywordtype">None</span>,<span class="keywordtype">None</span>),tree_node(1,1,<span class="keywordtype">None</span>,<span class="keywordtype">None</span>))
<a name="l00113"></a>00113             plotDivision = traverse(tree,plotElements[0][0],plotElements[0][1],plotElements[0][2]-plotElements[0][0],plotElements[0][3]-plotElements[0][1])
<a name="l00114"></a>00114             plotElements.insert(1,plotDivision[0])
<a name="l00115"></a>00115             plotElements.insert(2,plotDivision[1])
<a name="l00116"></a>00116             del plotElements[0]
<a name="l00117"></a>00117         <span class="keywordflow">else</span>:
<a name="l00118"></a>00118             <span class="keywordflow">if</span> plan[i][1] == 1.0:
<a name="l00119"></a>00119                 roomDesc.append(<span class="stringliteral">'</span><span class="stringliteral">R')</span>
<a name="l00120"></a>00120 <span class="stringliteral">            </span><span class="keywordflow">else</span>:
<a name="l00121"></a>00121                 roomDesc.append(<span class="stringliteral">'S'</span>)
<a name="l00122"></a>00122             plotRooms.append(plotElements[0])
<a name="l00123"></a>00123             del plotElements[0]
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     <span class="keywordflow">for</span> k <span class="keywordflow">in</span> xrange(0, len(roomDesc)):
<a name="l00126"></a>00126         plotRooms.insert(2*k,roomDesc[k])
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="keywordflow">return</span> plotRooms
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Tue Nov 27 11:56:03 2007 for IGA framework by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
